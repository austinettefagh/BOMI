!function(modules){var installedModules={};function __webpack_require__(moduleId){var module;return(installedModules[moduleId]||(module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}},modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module)).exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=149)}({1:function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){return memo=void 0===memo?Boolean(window&&document&&document.all&&!window.atob):memo}}(),getTarget=function getTarget(){var memo={};return function memorize(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count),id=(idCountMap[id]=count+1,getIndexByIdentifier(identifier)),count={css:item[1],media:item[2],sourceMap:item[3]};-1!==id?(stylesInDom[id].references++,stylesInDom[id].updater(count)):stylesInDom.push({identifier:identifier,updater:function addStyle(obj,options){var style,update,remove;{var styleIndex;remove=options.singleton?(styleIndex=singletonCounter++,style=singleton=singleton||insertStyleElement(options),update=applyToSingletonTag.bind(null,style,styleIndex,!1),applyToSingletonTag.bind(null,style,styleIndex,!0)):(style=insertStyleElement(options),update=function applyToTag(style,options,obj){var css=obj.css,media=obj.media,obj=obj.sourceMap;media?style.setAttribute("media",media):style.removeAttribute("media");obj&&"undefined"!=typeof btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(obj))))," */"));if(style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}.bind(null,style,options),function remove(){!function removeStyleElement(style){if(null===style.parentNode)return;style.parentNode.removeChild(style)}(style)})}return update(obj),function updateStyle(newObj){newObj?newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap||update(obj=newObj):remove()}}(count,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce&&(nonce=__webpack_require__.nc)&&(attributes.nonce=nonce),Object.keys(attributes).forEach(function(key){style.setAttribute(key,attributes[key])}),"function"==typeof options.insert)options.insert(style);else{var nonce=getTarget(options.insert||"head");if(!nonce)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");nonce.appendChild(style)}return style}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var remove=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;style.styleSheet?style.styleSheet.cssText=replaceText(index,remove):(obj=document.createTextNode(remove),(remove=style.childNodes)[index]&&style.removeChild(remove[index]),remove.length?style.insertBefore(obj,remove[index]):style.appendChild(obj))}var singleton=null,singletonCounter=0;module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function update(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newList=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newList}}}},149:function(module,exports,__webpack_require__){module.exports=__webpack_require__(150)},150:function(module,exports,__webpack_require__){__webpack_require__(151),__webpack_require__(152),__webpack_require__(153),__webpack_require__(154),__webpack_require__(156),__webpack_require__(158),__webpack_require__(160),__webpack_require__(162)},151:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(19),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},152:function(module,exports){!function(){"use strict";angular.module("ncOffers",["ncDataProviders","ncUI","ncPubsub","ncNavigator"])}()},153:function(module,exports){!function(){"use strict";angular.element(document).ready(function(){angular.bootstrap(document.getElementById("ncOffers"),["ncOffers"])})}()},154:function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncOffers").component("offers",{controllerAs:"offers",controller:["$scope","config","label","ui","pubsub","navigator","messageService","offersService",function($scope,config,label,ui,pubsub,navigator,messageService,offersService){var offers=this;function buildFieldSetPayload(identities,contextType){return{filters:{identities:identities,contextType:contextType}}}function adjustMetadata(metadata){return metadata.map(function(field){return~field.fieldPath.indexOf(".")&&(field.fieldPath=field.fieldPath.split(".")[1]),field})}function resetScorecard(scorecardsDto){0<scorecardsDto.records.length&&(offers.scorecard=scorecardsDto.records[0],offers.scorecard.attributes.LLC_BI__Description__c)&&(offers.reason=offers.scorecard.attributes.LLC_BI__Description__c)}offers.config=config.get(),offers.noOffersImageSrc=offers.config.noOffersImageSrc,offers.labels=label.getLabels(),offers.pubsub=pubsub,offers.navigator=navigator,offers.messageService=messageService,offers.loaded=!1,offers.offers=[],offers.collapsedCardMetadata=[],offers.expandedCardMetadata=[],offers.paymentStreamsMetadata=[],offers.rateStreamsMetadata=[],offers.combinedStreamsMetadata=[],offers.loadedCardMetadata=!1,offers.reason=null,offers.scorecard=null,offers.loanAmount=offers.config.loanAmount,offers.offerSorting=offers.config.defaultOfferSorting,offers.offerSortingOptions=offers.config.offerSortingOptions,offers.displayRecalculateOffers=offers.config.recalculateOffersFieldSet&&0<offers.config.recalculateOffersFieldSet.length,offers.$onInit=function(){offers.displayTopBarComponents(),offersService.retrieveOffers().then(function(offersDto){offers.offers=offersDto.records,0===offers.offers.length?offersService.retrieveScorecard().then(function(scorecardsDto){resetScorecard(scorecardsDto),console.log("There are no offers available within Matrix Manager for this loan. Please review the Base Rate Matrix in Matrix Manager to ensure there are no offers for this scenario."),offers.loaded=!0}):(offers.prepareFieldSetMetaData(),offers.setContinueButtonActive(!!offersService.getSelectedOffer()),offers.loaded=!0)})},offers.displayTopBarComponents=function(){offers.pubsub.publish(offers.pubsub.topics.ANCHOR_SET,{link:offers.config.topBarLink,text:offers.config.topBarText,src:offers.config.topBarIcon,background:offers.config.topBarIconBackground}),offers.pubsub.publish(LifeCycle.Topics.GlobalActionButtonHandler.HIDE_CONTINUE),offers.pubsub.publish(offers.pubsub.topics.PRIMARY_BUTTON_SET,{rendered:!0,disabled:!0,icon:"utility:forward",iconPosition:"right",text:offers.labels.Continue,styleClass:"slds-button slds-button_neutral",onClick:function(){offersService.getSelectedOffer()?offers.navigateToNextUrl():(offers.displayErrorMessage(offers.labels.No_Offer_Selected_Message),$scope.$apply())}})},offers.navigateToNextUrl=function(){var nextHref=offers.config.nextHref;nextHref?offers.navigator.navigateToRoute(nextHref):navigator.isSF1App()?window.top.location.href="/one/one.app#sObject/"+offers.config.contextId+"/view":offers.navigator.navigateToSObject(offers.config.contextId,null)},offers.hydrateNumberLabel=function(label,number){return label.replace("{#}",number)},offers.formatCurrency=function(number){return LifeCycle.Internationalize.format(number,LifeCycle.Internationalize.formats.numeric.CURRENCY)},offers.getOfferSortingField=function(offer){return parseFloat(offer.attributes[offers.offerSorting])},offers.setContinueButtonActive=function(enabled){pubsub.publish(offers.config.constants.PRIMARY_BUTTON_SET,{disabled:!enabled})},offers.displayErrorMessage=function(errorMessage){offers.messageService.setMessage({type:offers.messageService.messageTypes.error,text:errorMessage,canDismiss:!0},!0)},offers.applyOffer=function(offer){offer&&ui.block(),offersService.setSelectedOffer(offer).then(function(){offers.setContinueButtonActive(!!offer)}).catch(offers.displayErrorMessage).finally(function(){offer&&ui.unblock()})},offers.removeProductData=function(offer){return offer&&(offer.attributes=Object.keys(offer.attributes).reduce(function(attributes,attributeName){return-1===attributeName.indexOf("Product__r")&&(attributes[attributeName]=offer.attributes[attributeName]),attributes},{})),offer},offers.prepareFieldSetMetaData=function(){var fieldSetPayload=buildFieldSetPayload([offers.config.collapsedOfferCardFieldSet,offers.config.expandedOfferCardFieldSet],offers.config.constants.PRICING_OPTION_CONTEXT_TYPE),rateStreamsFieldSetPayload=buildFieldSetPayload([offers.config.rateStreamsFieldSet],"LLC_BI__Pricing_Rate_Component__c"),paymentStreamsFieldSetPayload=buildFieldSetPayload([offers.config.paymentStreamsFieldSet],"LLC_BI__Pricing_Payment_Component__c");try{offersService.loadFieldSetMetadata(fieldSetPayload).then(function(metadata){return offers.collapsedCardMetadata=metadata.fieldSetMetadataMap[offers.config.collapsedOfferCardFieldSet],offers.expandedCardMetadata=metadata.fieldSetMetadataMap[offers.config.expandedOfferCardFieldSet],offersService.loadFieldSetMetadata(rateStreamsFieldSetPayload)}).then(function(metadata){return offers.rateStreamsMetadata=adjustMetadata(metadata.fieldSetMetadataMap[offers.config.rateStreamsFieldSet]),offersService.loadFieldSetMetadata(paymentStreamsFieldSetPayload)}).then(function(metadata){offers.paymentStreamsMetadata=adjustMetadata(metadata.fieldSetMetadataMap[offers.config.paymentStreamsFieldSet]),offers.combinedStreamsMetadata=offers.paymentStreamsMetadata.concat(offers.rateStreamsMetadata),offers.loadedCardMetadata=!0})}catch(ex){offers.displayErrorMessage(ex.message)}},pubsub.subscribe(offers.config.constants.OFFER_SELECTED,function(offer){offers.applyOffer(offers.removeProductData(offer))}),pubsub.subscribe(offers.config.constants.NEW_OFFERS_LOADED,function(offersDto){offers.offers=offersDto.records,offers&&offers.offers&&0<offers.offers.length&&offers.prepareFieldSetMetaData()}),pubsub.subscribe(offers.config.constants.NEW_SCORECARD_LOADED,resetScorecard),pubsub.subscribe(offers.config.constants.NEW_LOAN_AMOUNT_LOADED,function(loanAmount){offers.loanAmount=loanAmount})}],template:__webpack_require__(155)})}()},155:function(module,exports){module.exports='<div class="slds-grid slds-grid_vertical"> <div class="slds-col slds-gutters_x-small"> <message/> </div> <div class="slds-col slds-grid"> <div class="slds-col--padded" ng-class="{ \'slds-size_3-of-4\': offers.displayRecalculateOffers, \'slds-size_1-of-1\': !offers.displayRecalculateOffers }"> <div class="slds-box slds-theme_default"> <div ng-if="offers.loaded && offers.offers.length === 0" class="slds-text-align_center slds-m-vertical_large"> <img ng-src="{{::offers.noOffersImageSrc}}" class="slds-p-bottom_medium"/> <div class="slds-text-heading_medium"> {{ offers.labels.No_Offers_Returned_Message }} </div> <div ng-if="offers.reason" class="slds-text-body_small slds-text-color_weak"> {{ offers.reason }} </div> </div> <div ng-if="offers.loaded && offers.offers.length > 0"> <div class="offer-heading-strong slds-m-vertical_small"> {{ offers.hydrateNumberLabel(offers.labels.Requested_Loan_Amount, offers.formatCurrency(offers.loanAmount)) }} </div> <div class="slds-text-title slds-m-bottom_large"> {{ offers.hydrateNumberLabel(offers.labels.Offers_Returned, offers.offers.length) }} <label> &bull; {{ offers.labels.Offers_Sorting_Preference }} <span ng-if="offers.offerSortingOptions.length === 1"> {{ offers.offerSortingOptions[0].label }} </span> <span ng-if="offers.offerSortingOptions.length > 1" class="slds-select_container offers-sorting-select"> <select ng-model="offers.offerSorting" class="slds-select"> <option ng-repeat="sortingOption in offers.offerSortingOptions" ng-value="sortingOption.field"> {{ sortingOption.label }} </option> </select> </span> </label> </div> <offers-card ng-show="offers.offers.length > 0" ng-repeat="offer in offers.offers | orderBy: offers.getOfferSortingField track by offer.identity" offer="offer" collapsed-card-metadata="offers.collapsedCardMetadata" expanded-card-metadata="offers.expandedCardMetadata" combined-streams-metadata="offers.combinedStreamsMetadata" ng-if="offers.loadedCardMetadata"></offers-card> </div> </div> </div> <div ng-if="offers.loaded && offers.displayRecalculateOffers" class="slds-col--padded slds-size_1-of-4"> <recalculate-offers></recalculate-offers> </div> </div> </div>'},156:function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncOffers").component("offersCard",{bindings:{offer:"=",collapsedCardMetadata:"<",expandedCardMetadata:"<",combinedStreamsMetadata:"<"},controllerAs:"offersCard",controller:["config","label","pubsub","offersService","messageService","$scope",function(config,label,pubsub,offersService,messageService,$scope){var offersCard=this;offersCard.config=config.get(),offersCard.isRetailPricingEnabled=offersCard.config.isRetailPricingEnabled,offersCard.labels=label.getLabels(),offersCard.pubsub=pubsub,offersCard.messageService=messageService,offersCard.loaded=!1,offersCard.showContent=!1,offersCard.paymentStreams=[],offersCard.rateStreams=[],offersCard.combinedStreams,offersCard.$onInit=function(){offersCard.loaded=!0,offersCard.ratesLoaded=!1,offersCard.isRetailPricingEnabled&&Promise.all([offersService.loadRateStreams([offersCard.offer.identity]),offersService.loadPaymentStreams([offersCard.offer.identity])]).then(results=>{offersCard.rateStreams=results[0],offersCard.paymentStreams=results[1],offersCard.joinStreamComponents()}).catch(ex=>{offersCard.displayErrorMessage(ex.message)}).finally(()=>{$scope.$apply(function(){offersCard.ratesLoaded=!0})})},offersCard.joinStreamComponents=function(){var combinedStreams=[];for(let i=0;i<offersCard.paymentStreams.length;i++){var combinedStream=offersCard.paymentStreams[i];combinedStream.streamComponents=offersCard.paymentStreams[i].streamComponents.concat(offersCard.rateStreams[i].streamComponents),combinedStreams.push(combinedStream)}offersCard.combinedStreams=combinedStreams},offersCard.toggleExpansion=function(){offersCard.showContent=offersCard.isDisabled()===offersCard.showContent},offersCard.changeSelectedState=function(event){event=event&&event.detail;offersCard.offer.isSelected=event,offersCard.pubsub.publish(offersCard.config.constants.OFFER_SELECTED,event?offersCard.offer:null)},offersCard.displayErrorMessage=function(errorMessage){offersCard.messageService.setMessage({type:offersCard.messageService.messageTypes.error,text:errorMessage,canDismiss:!0},!0)},offersCard.isDisabled=function(){return null!=offersService.getSelectedOffer()&&!offersCard.offer.isSelected},offersCard.getCardDisabledClasses=function(){return offersCard.isDisabled()?"offer-card-disabled":""},offersCard.getCardExpandedClasses=function(){return offersCard.showContent?"slds-is-open offer-border-expanded":""},offersCard.getIconClasses=function(){return"slds-section__title-action-icon"+(offersCard.isDisabled()?" action-icon-disabled":"")},offersCard.buildHomeLendingCalculationsMessage=function(){var hcmAporPercent,hcmSpreadPercent,message=[],attributes=offersCard.offer.attributes;return"true"===attributes.LLC_BI__Is_HCM__c&&(message.push(offersCard.labels.HCM),"true"===attributes.LLC_BI__HCM_APOR_Test__c&&(hcmAporPercent=offersCard.labels.APOR_Percent,hcmSpreadPercent=offersCard.labels.Spread_Percent,message.push(offersCard.labels.APOR_Spread_Exceeded,hcmAporPercent.replace("{0}",attributes.LLC_BI__HCM_APOR__c),hcmSpreadPercent.replace("{0}",attributes.LLC_BI__HCM_APOR_Spread__c),"<br/>")),"true"===attributes.LLC_BI__HCM_Points_And_Fees_Test__c)&&(hcmAporPercent=offersCard.labels.Total_Points_and_Fees,hcmSpreadPercent=offersCard.labels.Maximum_Points_and_Fees,message.push(offersCard.labels.Points_and_Fees_Amount_Exceeded,hcmAporPercent.replace("{0}",attributes.LLC_BI__Total_Points_And_Fees__c),hcmSpreadPercent.replace("{0}",attributes.LLC_BI__HCM_Maximum_Points_And_Fees__c),"<br/>")),"true"===attributes.LLC_BI__Is_HPML__c&&(1===message.length&&message.push("<br/>"),hcmAporPercent=offersCard.labels.APOR_Percent,hcmSpreadPercent=offersCard.labels.Spread_Percent,message.push(offersCard.labels.HPML,offersCard.labels.APOR_Spread_Exceeded,hcmAporPercent.replace("{0}",attributes.LLC_BI__HPML_APOR__c),hcmSpreadPercent.replace("{0}",attributes.LLC_BI__HPML_APOR_Spread__c))),"<br/>"===message[message.length-1]&&message.pop(),message}}],template:__webpack_require__(157)})}()},157:function(module,exports){module.exports='<div class="slds-section slds-box slds-p-around_medium offer-border" ng-class="[offersCard.getCardDisabledClasses(), offersCard.getCardExpandedClasses()]"> <div class="slds-grid"> <nds-badge class="slds-m-right_xx-small slds-p-top_xx-small" ng-if="offersCard.offer.attributes.LLC_BI__Is_HCM__c === \'true\'">{{ ::offersCard.labels.HCM }} </nds-badge> <nds-badge class="slds-m-right_xx-small slds-p-top_xx-small" ng-if="offersCard.offer.attributes.LLC_BI__Is_HPML__c === \'true\'">{{ ::offersCard.labels.HPML }} </nds-badge> <nds-tooltip ng-if="offersCard.offer.attributes.LLC_BI__Is_HCM__c === \'true\'\n            || offersCard.offer.attributes.LLC_BI__Is_HPML__c === \'true\'" id="{{ offersCard.offer.identity }}-offer-tooltip" icon-name="info" icon-type="utility" nubbin-position="left" message="" message-array="{{ offersCard.buildHomeLendingCalculationsMessage() }}" tooltip-type="icon" vg-class="slds-icon_small" size="small" svg-class="slds-icon-text-light" fill-color="brand"> </nds-tooltip> </div> <div class="slds-section__title slds-grid slds-wrap"> <div class="slds-col slds-grid slds-size_12-of-12 slds-large-size_3-of-12 slds-align-middle"> <nds-icon aria-controls="{{ offersCard.offer.identity }}-offer-card" aria-expanded="{{ offersCard.showContent }}" ng-click="offersCard.toggleExpansion()" icon-type="utility" icon-name="switch" fill="{{ ::offersCard.config.theme.brandDark }}" span-class="{{ offersCard.getIconClasses() }}" svg-class="slds-icon_small" class="offer-horizontal-align offers-switch-icon slds-m-right_medium"></nds-icon> <span class="offer-horizontal-align offer-name" ng-bind="offersCard.offer.attributes.Name"></span> </div> <div class="slds-col slds-size_12-of-12 slds-large-size_7-of-12 slds-align-middle slds-p-vertical_medium"> <nds-form id="{{ ::offersCard.offer.identity }}-collapsed-card" class="collapsed-offer-card" is-editable="false" form-entity="{{ ::offersCard.offer | json }}" form-metadata="{{ ::offersCard.collapsedCardMetadata | json }}" columns="{{ ::offersCard.collapsedCardMetadata.length }}" ng-if="offersCard.loaded"></nds-form> </div> <div class="slds-col slds-size_12-of-12 slds-large-size_2-of-12 slds-align-middle offers-card-select-btn"> <nds-button id="{{ offersCard.offer.identity }}-select" button-class="" ng-if="offersCard.loaded" theme="{{ offersCard.offer.isSelected ? \'brand\' : \'neutral\' }}" state="{{ ::offersCard.offer.isSelected }}" ng-disabled="offersCard.isDisabled()" ng-on-button_click="offersCard.changeSelectedState($event.originalEvent)"> <span class="slds-text-not-pressed" ng-bind="offersCard.labels.Select_Offer"></span> <span class="slds-text-pressed" ng-bind="offersCard.labels.Offer_Selected"></span> </nds-button> </div> </div> <div aria-hidden="{{ !offersCard.showContent }}" class="slds-section__content" id="{{ offersCard.offer.identity }}-offer-card"> <hr class="slds-m-vertical_xx-small offer-card-divider"/> <nds-form id="{{ ::offersCard.offer.identity }}-expanded-card" class="expanded-offer-card" is-editable="false" form-entity="{{ ::offersCard.offer | json }}" form-metadata="{{ ::offersCard.expandedCardMetadata | json }}" columns="{{ ::offersCard.expandedCardMetadata.length }}" ng-if="offersCard.loaded"> </nds-form> <div class="slds-scrollable" ng-if="offersCard.isRetailPricingEnabled"> <hr class="slds-m-vertical_xx-small offer-card-divider"/> <span> <streams-table ng-if="offersCard.combinedStreams" streams="offersCard.combinedStreams" metadata="offersCard.combinedStreamsMetadata" is-loaded="offersCard.ratesLoaded"> </streams-table> </span> </div> </div> </div> '},158:function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncOffers").component("streamsTable",{bindings:{streams:"<",metadata:"<",isLoaded:"="},controllerAs:"streamsTable",controller:[function(){var streamsTable=this;streamsTable.$onInit=function(){streamsTable.fieldsHaveValue()},streamsTable.fieldsHaveValue=function(){for(var i=0;i<streamsTable.metadata.length;i++){var field=streamsTable.metadata[i];field.hasFieldValue=streamsTable.checkStreamsForValue(field)}},streamsTable.checkStreamsForValue=function(field){for(var i=0;i<streamsTable.streams.length;i++){var stream=streamsTable.streams[i];if(stream.attributes[field.fieldPath])return!0;if(streamsTable.checkStreamComponentForValue(field,stream))return!0}return!1},streamsTable.checkStreamComponentForValue=function(field,stream){for(var i=0;i<stream.streamComponents.length;i++)if(stream.streamComponents[i].attributes[field.fieldPath])return!0;return!1}}],template:__webpack_require__(159)})}()},159:function(module,exports){module.exports='<div> <div ng-if="!streamsTable.isLoaded" class="slds-grid slds-grid_align-center slds-grid_vertical-align-center slds-p-top_small"> <nds-spinner theme="brand" inline="true"></nds-spinner> </div> <table ng-if="streamsTable.isLoaded" class="slds-table slds-table_cell-buffer slds-no-row-hover slds-table_bordered" role="grid" aria-label=""> <thead> <tr class="slds-line-height_reset"> <th ng-repeat="field in streamsTable.metadata" ng-if="field.hasFieldValue" class="" scope="col"> <div title="{{field.label}}"> {{field.label}} </div> </th> </tr> </thead> <tbody> <tr ng-repeat="stream in streamsTable.streams"> <td ng-if="field.hasFieldValue" class="slds-cell-wrap" ng-repeat="field in streamsTable.metadata" scope="row"> <nds-form-element ng-if="stream.attributes[field.fieldPath]" nds-control hide-label="true" use-milliseconds="true" is-editable="false" metadata="{{field}}" value="{{stream.attributes[field.fieldPath]}}" display-value=""> </nds-form-element> <span ng-if="!stream.attributes[field.fieldPath] && stream.streamComponents"> <div ng-repeat="streamComponent in stream.streamComponents"> <nds-form-element nds-control hide-label="true" use-milliseconds="true" is-editable="false" metadata="{{field}}" value="{{streamComponent.attributes[field.fieldPath]}}" display-value=""> </nds-form-element> </div> </span> </td> </tr> </tbody> </table> </div> '},160:function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncOffers").component("recalculateOffers",{controllerAs:"recalculateOffers",controller:["$scope","config","label","ui","messageService","offersService",function($scope,config,label,ui,messageService,offersService){var recalculateOffers=this;recalculateOffers.config=config.get(),recalculateOffers.labels=label.getLabels(),recalculateOffers.recalculateOfferFormChanged=!1,recalculateOffers.loaded=!1,recalculateOffers.fieldSetName=recalculateOffers.config.recalculateOffersFieldSet,recalculateOffers.fieldSetContextType=recalculateOffers.config.isMortgage?recalculateOffers.config.constants.MORTGAGE_CONTEXT_TYPE:recalculateOffers.config.constants.LOAN_CONTEXT_TYPE,recalculateOffers.form={entity:{},metadata:[]},recalculateOffers.$onInit=function(){var fieldSetPayload;recalculateOffers.fieldSetName&&(fieldSetPayload={filters:{identities:[recalculateOffers.fieldSetName],contextType:recalculateOffers.fieldSetContextType}},offersService.loadFieldSetMetadata(fieldSetPayload).then(function(metadata){recalculateOffers.form.metadata=metadata.fieldSetMetadataMap[recalculateOffers.fieldSetName],offersService.retrieveRecalculateRecord().then(function(dto){0<dto.records.length&&(recalculateOffers.form.entity=dto.records[0]),recalculateOffers.loaded=!0})}))},recalculateOffers.recalculateOffers=function(){ui.block(),offersService.recalculateOffers({records:[recalculateOffers.form.entity]}).then(function(){recalculateOffers.recalculateOfferFormChanged=!1}).catch(function(error){messageService.setMessage({canDismiss:!0,type:messageService.messageTypes.error,text:error},!0),$scope.$apply()}).finally(ui.unblock)},recalculateOffers.handleFormChange=function($event){$event=$event.originalEvent.detail;recalculateOffers.form.entity.attributes[$event.fieldPath]=$event.value,recalculateOffers.recalculateOfferFormChanged=!0}}],template:__webpack_require__(161)})}()},161:function(module,exports){module.exports='<div ng-if="recalculateOffers.loaded" class="slds-box slds-theme_default"> <div class="slds-text-heading_small slds-m-bottom_small"> {{ ::recalculateOffers.labels.Recalculate_Offers }} </div> <div class="slds-m-bottom_medium"> <nds-form id="recalculate-offers-form" is-editable="true" form-entity="{{ ::recalculateOffers.form.entity | json }}" form-metadata="{{ ::recalculateOffers.form.metadata | json }}" columns="1" ng-on-form_value_change="recalculateOffers.handleFormChange($event)" ng-on-keyup="recalculateOffers.recalculateOfferFormChanged = true"></nds-form> </div> <nds-button theme="neutral" ng-disabled="!recalculateOffers.recalculateOfferFormChanged" ng-click="recalculateOffers.recalculateOffers()"> {{ ::recalculateOffers.labels.Recalculate_Offers_Button }} </nds-button> </div> '},162:function(module,exports){!function(){"use strict";angular.module("ncOffers").service("offersService",function OffersService(config,$q,remotingManager,pubsub){var service=this,configData=config.get(),selectedOffer=null,selectedOfferId=configData.selectedOfferId||null,isMortgage=configData.isMortgage;function runAutoDecision(){return invokeRemoteAction(configData.endpoints.runAutoDecision,{loanId:configData.contextId})}function loadStreams(resource,identities,fieldSets){return $q(function(resolve,reject){invokeRemoteAction(resource,{args:JSON.stringify({fieldSets:fieldSets,filters:{identities:identities}})}).then(function(streams){resolve(streams)}).catch(function(error){reject(error)})})}function retrieveOffers(){return $q(function(resolve,reject){invokeRemoteAction(configData.endpoints.retrieveOffers,{args:JSON.stringify({loanId:configData.contextId,fieldSetNames:[configData.collapsedOfferCardFieldSet,configData.expandedOfferCardFieldSet]})}).then(function(offersDto){var offersRecords=offersDto.records;selectedOffer=null,selectedOfferId&&(selectedOffer=offersRecords.find(function(offerRecord){return selectedOfferId===offerRecord.identity}))&&(selectedOffer.isSelected=!0),resolve(offersDto)}).catch(reject)})}function retrieveScorecard(){return invokeRemoteAction(configData.endpoints.retrieveScorecard,{loanId:configData.contextId})}function calculateNewMortgageInsuranceEstimate(){return invokeRemoteAction(configData.endpoints.calculateNewMortgageInsuranceEstimate,{loanId:configData.contextId})}function generateNewOffers(){return invokeRemoteAction(configData.endpoints.generateNewOffers,{loanId:configData.contextId})}function calculateOffersDTI(){return invokeRemoteAction(configData.endpoints.calculateOffersDTI,{loanId:configData.contextId})}function filterOffersByDTI(){return invokeRemoteAction(configData.endpoints.filterOffersByDTI,{loanId:configData.contextId})}function calculateAllOffers(offers){offers=offers.records.map(function(offer){return invokeRemoteAction(configData.endpoints.calculateOffer,{args:JSON.stringify({offerId:offer.identity})})});return $q.all(offers)}function complianceCalculations(data){var promises=[],offers=data.processHCM;return offers.length&&promises.push(function calculateHcm(offerIds){offerIds=offerIds.map(function(offerId){return invokeRemoteAction(configData.endpoints.calculateOffer,{args:JSON.stringify({offerId:offerId,processHCM:!0})})});return $q.all(offerIds)}(offers)),(offers=data.processHPML).length&&promises.push(function calculateHpml(offerIds){offerIds=offerIds.map(function(offerId){return invokeRemoteAction(configData.endpoints.calculateOffer,{args:JSON.stringify({offerId:offerId,processHPML:!0})})});return $q.all(offerIds)}(offers)),$q.all(promises)}function updateScorecard(offers){var deferred=$q.defer();return 0===offers.records.length?retrieveScorecard().then(function(scorecardsDto){!function resetScorecard(scorecardsDto){pubsub.publish(configData.constants.NEW_SCORECARD_LOADED,scorecardsDto)}(scorecardsDto),deferred.resolve(offers)}):deferred.resolve(offers),deferred.promise}function resetOffers(offers){var deferred=$q.defer();return service.setSelectedOffer(null),pubsub.publish(configData.constants.NEW_OFFERS_LOADED,offers),deferred.resolve()}function retrieveLoanAmount(){return invokeRemoteAction(configData.endpoints.retrieveLoanAmount,{loanId:configData.contextId})}function resetLoanAmount(loanAmount){var deferred=$q.defer();return pubsub.publish(configData.constants.NEW_LOAN_AMOUNT_LOADED,loanAmount),deferred.resolve()}function invokeRemoteAction(endpointAction,endpointParams){var deferred=$q.defer();return remotingManager.invokeAction(configData.endpoints.remoteActionInvoke,endpointAction,endpointParams,function(results,event){event.status?deferred.resolve(results):deferred.reject(event.message)},{escape:!1,buffer:!1}),deferred.promise}service.runAutoDecision=runAutoDecision,service.loadRateStreams=function loadRateStreams(identities){return loadStreams(configData.endpoints.loadRateStreams,identities,[configData.rateStreamsFieldSet])},service.loadPaymentStreams=function loadPaymentStreams(identities){return loadStreams(configData.endpoints.loadPaymentStreams,identities,[configData.paymentStreamsFieldSet])},service.retrieveOffers=retrieveOffers,service.retrieveScorecard=retrieveScorecard,service.retrieveRecalculateRecord=function(){return invokeRemoteAction(isMortgage?configData.endpoints.retrieveMortgage:configData.endpoints.retrieveLoan,{loanId:configData.contextId,fieldSetName:configData.recalculateOffersFieldSet})},service.recalculateOffers=function(dto){return function updateLoanRecords(dto){return invokeRemoteAction(configData.endpoints.updateLoanRecords,{args:JSON.stringify({dto:dto,fieldSetName:configData.recalculateOffersFieldSet,isMortgage:isMortgage})})}(dto).then(calculateNewMortgageInsuranceEstimate).then(generateNewOffers).then(calculateAllOffers).then(calculateOffersDTI).then(filterOffersByDTI).then(complianceCalculations).then(runAutoDecision).then(retrieveOffers).then(updateScorecard).then(resetOffers).then(retrieveLoanAmount).then(resetLoanAmount)},service.loadFieldSetMetadata=function(params){return invokeRemoteAction(configData.endpoints.loadFieldSetMetadata,{args:JSON.stringify(params)})},service.applyOffer=function(params){return invokeRemoteAction(configData.endpoints.applyOffer,{args:JSON.stringify(params)})},service.getSelectedOffer=function(){return selectedOffer},service.calculatePrepaidInterestForLoan=function(){return invokeRemoteAction(configData.endpoints.calculateOffer,{args:JSON.stringify({offerId:configData.contextId})})},service.setSelectedOffer=function(offer){return $q(function(resolve,reject){var payload;selectedOfferId=(selectedOffer=offer)?offer.identity:null,selectedOffer?(payload={loanId:configData.contextId,offer:selectedOffer,fieldSetNames:[configData.collapsedOfferCardFieldSet,configData.expandedOfferCardFieldSet]},service.applyOffer(payload).then(function(shouldCalculatePrepaidInterestForLoan){shouldCalculatePrepaidInterestForLoan&&service.calculatePrepaidInterestForLoan()}).then(resolve,reject)):resolve()})}})}()},19:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,"/* nFORCE__Template_Landing Overrides */\n\nhtml {\n  font-size: unset!important;\n}\n\n.slds-scope:not(html),\n.slds-scope body,\n.force .body-content .row.view-container,\n#bodyTable.outerNoSidebar {\n  background: #f4f6f9;\n  border: 0px;\n}\n\n.offers {\n  background-color: white;\n}\n\n.offer-card {\n  padding: 1em;\n}\n\n.offers-card-select-btn {\n  text-align: center;\n}\n\n.offer-name {\n  color: #0070d2;\n  font-size: 1.125em;\n  word-break: break-word;\n  width: 100%;\n}\n\n.offer-horizontal-align {\n  margin-top: auto;\n  margin-bottom: auto;\n}\n\n.offer-heading-strong {\n  font-weight: 400;\n  font-size: 1.25rem;\n  line-height: 1.25;\n\n  margin: 0.75rem 0;\n}\n\n.slds-scope .slds-box.offer-border {\n  border: solid 1px rgba(210, 219, 226, 0.8);\n  border-radius: 0.5rem;\n}\n\n.slds-scope .slds-box.offer-border-expanded {\n  border: solid 1px #008aea;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.16);\n}\n\n.slds .offers {\n  margin-right: -1.75rem;\n  margin-left: -1.75rem;\n}\n\n.offers-sorting-select {\n  display: inline-block;\n}\n\n.slds-scope .slds-section__title-action-icon {\n  cursor: pointer;\n  transition-duration: 0.3s;\n}\n\n.slds-scope .slds-section__title-action-icon.action-icon-disabled {\n  cursor: default;\n}\n\n.slds-scope .slds-button.slds-button_neutral:not([disabled]) {\n  color: #0070d2;\n}\n\nnds-form.collapsed-offer-card .slds-form-element__label {\n  align-content: center;\n  align-items: center;\n  color: #788991;\n  display: flex;\n  font-size: 0.675rem;\n  justify-content: center;\n  margin: auto;\n  padding: 0;\n  text-transform: uppercase;\n  white-space: nowrap;\n}\n\nnds-form.collapsed-offer-card .slds-form-element__control .slds-text-body_regular {\n  align-content: center;\n  align-items: center;\n  color: #16325c;\n  display: flex;\n  font-size: 1.125rem;\n  justify-content: center;\n  margin: auto;\n}\n\nnds-form.expanded-offer-card .slds-form-element__label {\n  color: #788991;\n  text-align: center;\n}\n\nnds-form.expanded-offer-card .slds-form-element__control .slds-text-body_regular {\n  color: #16325c;\n}\n\n.slds-scope .offer-card-divider {\n  height: 1rem;\n  opacity: 0.32;\n}\n\n.offer-card-disabled {\n  opacity: 0.32;\n}\n\n.slds-scope .slds-section.slds-is-open .offers-switch-icon .slds-section__title-action-icon {\n  transform-origin: 50%;\n}\n\ndiv.slds-popover__body {\n  width: max-content;\n}\n\nnds-tooltip nds-popover .slds-popover {\n  min-width: 250px;\n  text-align: left;\n  overflow-wrap: normal;\n}\n\nslot-fb > div {\n  max-width: 250px;\n}\n\n@media (min-width: 64rem) {\n  .offers-card-select-btn nds-button {\n    float: right;\n  }\n  .offer-name {\n    font-size: 1.25em;\n  }\n  .nds-form.collapsed-offer-card .slds-form-element__control .slds-text-body_regular {\n    font-size: 1.25rem;\n  }\n  nds-form.collapsed-offer-card .slds-form-element__label {\n    font-size: 0.75rem;\n  }\n}",""]),__webpack_exports__.a=__webpack_require__},2:function(module,exports,__webpack_require__){"use strict";module.exports=function(cssWithMappingToString){var list=[];return list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content}).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}}});