!function(modules){var installedModules={};function __webpack_require__(moduleId){var module;return(installedModules[moduleId]||(module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}},modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module)).exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=83)}([,function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){return memo=void 0===memo?Boolean(window&&document&&document.all&&!window.atob):memo}}(),getTarget=function getTarget(){var memo={};return function memorize(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count),id=(idCountMap[id]=count+1,getIndexByIdentifier(identifier)),count={css:item[1],media:item[2],sourceMap:item[3]};-1!==id?(stylesInDom[id].references++,stylesInDom[id].updater(count)):stylesInDom.push({identifier:identifier,updater:function addStyle(obj,options){var style,update,remove;{var styleIndex;remove=options.singleton?(styleIndex=singletonCounter++,style=singleton=singleton||insertStyleElement(options),update=applyToSingletonTag.bind(null,style,styleIndex,!1),applyToSingletonTag.bind(null,style,styleIndex,!0)):(style=insertStyleElement(options),update=function applyToTag(style,options,obj){var css=obj.css,media=obj.media,obj=obj.sourceMap;media?style.setAttribute("media",media):style.removeAttribute("media");obj&&"undefined"!=typeof btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(obj))))," */"));if(style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}.bind(null,style,options),function remove(){!function removeStyleElement(style){if(null===style.parentNode)return;style.parentNode.removeChild(style)}(style)})}return update(obj),function updateStyle(newObj){newObj?newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap||update(obj=newObj):remove()}}(count,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce&&(nonce=__webpack_require__.nc)&&(attributes.nonce=nonce),Object.keys(attributes).forEach(function(key){style.setAttribute(key,attributes[key])}),"function"==typeof options.insert)options.insert(style);else{var nonce=getTarget(options.insert||"head");if(!nonce)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");nonce.appendChild(style)}return style}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var remove=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;style.styleSheet?style.styleSheet.cssText=replaceText(index,remove):(obj=document.createTextNode(remove),(remove=style.childNodes)[index]&&style.removeChild(remove[index]),remove.length?style.insertBefore(obj,remove[index]):style.appendChild(obj))}var singleton=null,singletonCounter=0;module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function update(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newList=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newList}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(cssWithMappingToString){var list=[];return list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content}).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,"",""]),__webpack_exports__.a=__webpack_require__},function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,"",""]),__webpack_exports__.a=__webpack_require__},function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,".section-header {\n\tcolor: #405883;\n\tmargin: 15px;\n\tpadding: 10px;\n\tbackground-color: #F4F6F8;\n\tborder-radius: 4px;\n}",""]),__webpack_exports__.a=__webpack_require__},function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,"",""]),__webpack_exports__.a=__webpack_require__},function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__)()(function(i){return i[1]});__webpack_require__.push([module.i,"nds-input-lookup table {\n\tborder: 1px solid #d8dde6;\n} \n",""]),__webpack_exports__.a=__webpack_require__},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){module.exports=__webpack_require__(84)},function(module,exports,__webpack_require__){__webpack_require__(85),__webpack_require__(86),__webpack_require__(87),__webpack_require__(88),__webpack_require__(89),__webpack_require__(90),__webpack_require__(91),__webpack_require__(92),__webpack_require__(94),__webpack_require__(96),__webpack_require__(98),__webpack_require__(100),__webpack_require__(102),__webpack_require__(104),__webpack_require__(105),__webpack_require__(106)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(11),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(12),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(13),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(14),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),__webpack_require__=__webpack_require__(15),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__()(__webpack_require__.a,options);__webpack_exports__.default=__webpack_require__.a.locals||{}},function(module,exports){!function(){"use strict";angular.module("ncAddLoanCollateral",["ncDataProviders","ncUI","ncPubsub","ncCollateralUtil"])}()},function(module,exports){!function(){"use strict";angular.element(document).ready(function(){angular.bootstrap(document.getElementById("ncAddLoanCollateral"),["ncAddLoanCollateral"])})}()},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("addLoanCollateral",{controllerAs:"addLoanCollateral",bindings:{isLeasedAsset:"<?",vehicleValuationProvider:"<?",editCollateral:"<?"},controller:["config","label","pubsub","alcConstants","addLoanCollateralService","collateralDtosService",function(config,label,pubsub,alcConstants,addLoanCollateralService,collateralDtosService){var addLoanCollateral=this;addLoanCollateral.config=config.get(),addLoanCollateral.labels=label.getLabels(),addLoanCollateral.loaded=!1,addLoanCollateral.valuationState=null,addLoanCollateral.showValuation=!0,addLoanCollateral.typesLoaded=!1,addLoanCollateral.collateralLoaded=!1,addLoanCollateral.$onInit=function(){pubsub.subscribe(alcConstants.topics.valuationState,function(state){addLoanCollateral.showValuation=!state.showVehicleValuation||state.isManualValuation}),pubsub.subscribe(alcConstants.topics.typesLoaded,function(state){addLoanCollateral.typesLoaded=!0,addLoanCollateral.collateralLoaded&&addLoanCollateral.afterEditLoaded()}),addLoanCollateral.editCollateral?addLoanCollateral.collateralPromise=addLoanCollateralService.getCollaterals(addLoanCollateral.editCollateral).then(function(result){collateralDtosService.setFullDto(result.collaterals[0]),addLoanCollateral.loaded=!0,addLoanCollateral.collateralLoaded=!0,addLoanCollateral.typesLoaded&&addLoanCollateral.afterEditLoaded()}):addLoanCollateral.loaded=!0},addLoanCollateral.afterEditLoaded=function(){var type=collateralDtosService.getCollateralDto().attributes.LLC_BI__Collateral_Type__c.value;pubsub.publish(alcConstants.topics.editLoaded,type)},addLoanCollateral.$onDestroy=function(){pubsub.unsubscribe(alcConstants.topics.valuationState),pubsub.unsubscribe(alcConstants.topics.typesLoaded)}}],template:__webpack_require__(93)})}()},function(module,exports){module.exports='<div> <select-collateral-type ng-if="addLoanCollateral.isLeasedAsset != null" is-leased-asset="addLoanCollateral.isLeasedAsset" edit-collateral="addLoanCollateral.editCollateral"> </select-collateral-type> <add-collateral-ownership edit-collateral="addLoanCollateral.editCollateral"> </add-collateral-ownership> <vehicle-valuation ng-if="addLoanCollateral.editCollateral == undefined" vehicle-valuation-provider="addLoanCollateral.vehicleValuationProvider"> </vehicle-valuation> <add-collateral-valuation ng-show="addLoanCollateral.showValuation" edit-collateral="addLoanCollateral.editCollateral"> </add-collateral-valuation> </div> '},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("addLoanCollateralModal",{controllerAs:"addLoanCollateralModal",bindings:{isLeasedAsset:"<?",vehicleValuationProvider:"<?",editCollateral:"<?",close:"<",currentApp:"<",currentPage:"<"},controller:["config","label","pubsub","alcConstants","addLoanCollateralService","collateralDtosService","navigator",function(config,label,pubsub,alcConstants,addLoanCollateralService,collateralDtosService,navigator){var addLoanCollateralModal=this;addLoanCollateralModal.config=config.get(),addLoanCollateralModal.labels=label.getLabels(),addLoanCollateralModal.loaded=!1,addLoanCollateralModal.showModal=!0,addLoanCollateralModal.showLoadingIcon=!0,addLoanCollateralModal.hasError=!1,addLoanCollateralModal.primaryDisabled=!0,addLoanCollateralModal.fieldsetNames=null,addLoanCollateralModal.ownershipFieldset=null,addLoanCollateralModal.valuationState=null,addLoanCollateralModal.primaryLabel=addLoanCollateralModal.labels.saveCollateral,addLoanCollateralModal.collateralValuationFieldMetadatas=null,addLoanCollateralModal.ownershipFieldMetadata=null,addLoanCollateralModal.$onInit=function(){pubsub.subscribe(alcConstants.topics.valuationState,function(state){addLoanCollateralModal.valuationState=state,addLoanCollateralModal.updateModalState()}),pubsub.subscribe(alcConstants.topics.showLoadingIcon,function(showLoadingIcon){addLoanCollateralModal.showLoadingIcon=showLoadingIcon}),pubsub.subscribe(alcConstants.topics.collateralFieldsets,function(fieldsetNames){addLoanCollateralModal.fieldsetNames=JSON.parse(fieldsetNames),addLoanCollateralModal.checkIsValid()}),pubsub.subscribe(alcConstants.topics.ownershipFieldset,function(ownershipFieldset){addLoanCollateralModal.ownershipFieldset=ownershipFieldset,addLoanCollateralModal.checkIsValid()}),pubsub.subscribe(alcConstants.topics.hasError,function(message){addLoanCollateralModal.toastMessage=message,addLoanCollateralModal.hasError=!0}),pubsub.subscribe(alcConstants.topics.collateralFieldsetMetadatas,function(fieldMetadatas){addLoanCollateralModal.collateralValuationFieldMetadatas=JSON.parse(fieldMetadatas)}),pubsub.subscribe(alcConstants.topics.ownershipFieldsetMetadata,function(ownershipFieldMetadata){addLoanCollateralModal.ownershipFieldMetadata=JSON.parse(ownershipFieldMetadata)}),addLoanCollateralModal.header=void 0!==addLoanCollateralModal.editCollateral?addLoanCollateralModal.labels.editHeader:addLoanCollateralModal.labels.addHeader,addLoanCollateralModal.editCollateral?addLoanCollateralModal.primaryAction=addLoanCollateralModal.saveEdit:addLoanCollateralModal.primaryAction=addLoanCollateralModal.navigateToPledge,addLoanCollateralModal.loaded=!0},addLoanCollateralModal.$onDestroy=function(){pubsub.unsubscribe(alcConstants.topics.valuationState),pubsub.unsubscribe(alcConstants.topics.showLoadingIcon),pubsub.unsubscribe(alcConstants.topics.collateralFieldsets),pubsub.unsubscribe(alcConstants.topics.ownershipFieldset),pubsub.unsubscribe(alcConstants.topics.hasError)},addLoanCollateralModal.cancel=function(){addLoanCollateralModal.closeModal()},addLoanCollateralModal.saveCollateral=function(){var formattedCollateralEntity=addLoanCollateralModal.formatDatetimes(collateralDtosService.getCollateralDto());return formattedCollateralEntity.collateralAssociationsXPkgDtos.push(...collateralDtosService.getRemovedAssociations()),addLoanCollateralService.saveCollaterals(formattedCollateralEntity,addLoanCollateralModal.fieldsetNames,addLoanCollateralModal.ownershipFieldset)},addLoanCollateralModal.formatDatetimes=function(entity){var collateralEntity=JSON.parse(JSON.stringify(entity));return addLoanCollateralModal.collateralValuationFieldMetadatas&&addLoanCollateralModal.collateralValuationFieldMetadatas.forEach(function(fieldSetMetadata){fieldSetMetadata.fieldMetadata&&fieldSetMetadata.fieldMetadata.forEach(function(fieldData){var path=fieldData.fieldPath.split(".");1==path.length?addLoanCollateralModal.transformDate(collateralEntity,fieldData.fieldPath,fieldData.fieldType):addLoanCollateralModal.transformDate(collateralEntity.collateralDetail,path[1],fieldData.fieldType)})}),addLoanCollateralModal.ownershipFieldMetadata&&addLoanCollateralModal.ownershipFieldMetadata.forEach(function(fieldData){collateralEntity.collateralAssociationsXPkgDtos&&collateralEntity.collateralAssociationsXPkgDtos.forEach(function(association){addLoanCollateralModal.transformDate(association,fieldData.fieldPath,fieldData.fieldType)})}),collateralEntity},addLoanCollateralModal.transformDate=function(dto,fieldPath,fieldType){var isoString,newDate,attribute=dto.attributes[fieldPath];attribute&&attribute.value&&(attribute=attribute.value,"DATE"===fieldType?(isoString=(newDate=new Date(parseInt(attribute))).toISOString(),dto.attributes[fieldPath].value=isoString.substr(0,isoString.indexOf("T"))):"DATETIME"===fieldType&&(newDate=new Date(parseInt(attribute)),dto.attributes[fieldPath].value=newDate.toISOString().replace("Z","")))},addLoanCollateralModal.navigateToPledge=function(){addLoanCollateralModal.showLoadingIcon=!0,addLoanCollateralModal.primaryDisabled=!0,addLoanCollateralModal.saveCollateral().then(function(result){result=result.outboundCollateralDtos.map(function(dto){return{collateralId:dto.identity}});pubsub.publish(alcConstants.topics.buildPledgeModel,JSON.stringify(result))}).catch(function(error){addLoanCollateralModal.showLoadingIcon=!1,addLoanCollateralModal.toastMessage=error,addLoanCollateralModal.primaryDisabled=!1,addLoanCollateralModal.hasError=!0})},addLoanCollateralModal.saveEdit=function(){addLoanCollateralModal.showLoadingIcon=!0,addLoanCollateralModal.primaryDisabled=!0,addLoanCollateralModal.saveCollateral().then(function(result){addLoanCollateralModal.closeModal()}).catch(function(error){addLoanCollateralModal.showLoadingIcon=!1,addLoanCollateralModal.toastMessage=error,addLoanCollateralModal.primaryDisabled=!1,addLoanCollateralModal.hasError=!0})},addLoanCollateralModal.navigateToVehicleValuation=function(){addLoanCollateralModal.showLoadingIcon=!0,addLoanCollateralModal.primaryDisabled=!0,collateralDtosService.resetAttributes(),addLoanCollateralModal.saveCollateral().then(function(result){result=alcConstants.apex+addLoanCollateralModal.currentPage+alcConstants.appVariable+addLoanCollateralModal.currentApp.split(".")[0]+"."+alcConstants.vehicleValuationApp+alcConstants.idVariable+addLoanCollateralModal.config.contextId+alcConstants.collateralVariable+result.outboundCollateralDtos[0].identity;navigator.isSF1App()?sforce.one.navigateToURL(result,!0):navigator.navigateToRoute(result),addLoanCollateralModal.showLoadingIcon=!1,addLoanCollateralModal.closeModal()}).catch(function(error){addLoanCollateralModal.showLoadingIcon=!1,addLoanCollateralModal.toastMessage=error,addLoanCollateralModal.primaryDisabled=!1,addLoanCollateralModal.hasError=!0})},addLoanCollateralModal.updateModalState=function(){!addLoanCollateralModal.valuationState.showVehicleValuation||addLoanCollateralModal.valuationState.isManualValuation?(addLoanCollateralModal.primaryAction=addLoanCollateralModal.navigateToPledge,addLoanCollateralModal.primaryLabel=addLoanCollateralModal.labels.saveCollateral):addLoanCollateralModal.valuationState.isProviderValuation&&(addLoanCollateralModal.primaryAction=addLoanCollateralModal.navigateToVehicleValuation,addLoanCollateralModal.primaryLabel=addLoanCollateralModal.labels.Continue_To_Valuation)},addLoanCollateralModal.checkIsValid=function(){null!=addLoanCollateralModal.fieldsetNames&&null!=addLoanCollateralModal.ownershipFieldset?addLoanCollateralModal.primaryDisabled=!1:addLoanCollateralModal.primaryDisabled=!0},addLoanCollateralModal.closeModal=function(){collateralDtosService.resetRemoved(),addLoanCollateralModal.close()},addLoanCollateralModal.clearToast=function(){addLoanCollateralModal.toastMessage="",addLoanCollateralModal.hasError=!1}}],template:__webpack_require__(95)})}()},function(module,exports){module.exports='<nds-modal size="large" loading="{{ addLoanCollateralModal.showLoadingIcon }}" close-title="{{ addLoanCollateralModal.labels.cancel }}" ng-on-modal_close="addLoanCollateralModal.cancel()" primary-disabled="addLoanCollateralModal.primaryDisabled" header-id="add-loan-collateral-modal"> <div slot="header"> <h2 id="add-loan-collateral-modal-header" class="slds-modal__title" ng-bind="::addLoanCollateralModal.header"></h2> </div> <div slot="content"> <nds-toast ng-if="addLoanCollateralModal.hasError" message="{{ addLoanCollateralModal.toastMessage }}" variant="error" variant-title="error" close-title="{{ addLoanCollateralModal.labels.cancel }}" ng-on-toast_close="addLoanCollateralModal.clearToast()"></nds-toast> <div class="slds-section slds-is-open"> <add-loan-collateral is-leased-asset="addLoanCollateralModal.isLeasedAsset" vehicle-valuation-provider="addLoanCollateralModal.vehicleValuationProvider" edit-collateral="addLoanCollateralModal.editCollateral"> </add-loan-collateral> </div> </div> <div slot="footer"> <span id="vvRouteWarning2"> <span ng-if="\n\t\t\t\t\taddLoanCollateralModal.valuationState &&\n\t\t\t\t\taddLoanCollateralModal.valuationState.showVehicleValuation &&\n\t\t\t\t\taddLoanCollateralModal.valuationState.routeMissing\n\t\t\t\t" data-popover="popover" class="popover-icon-warning" data-content="{{ addLoanCollateralModal.labels.Vehicle_Valuation_Route_Warning }}" ng-include="addLoanCollateralModal.config.warningIcon"> </span> </span> <nds-button theme="neutral" ng-click="addLoanCollateralModal.cancel()" ng-bind="addLoanCollateralModal.labels.cancel"></nds-button> <nds-button ng-disabled="addLoanCollateralModal.primaryDisabled" theme="brand" ng-click="addLoanCollateralModal.primaryAction()">{{ addLoanCollateralModal.primaryLabel }}</nds-button> </div> </nds-modal> '},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("addCollateralOwnership",{controllerAs:"addCollateralOwnership",bindings:{editCollateral:"<?"},controller:["$q","config","label","addLoanCollateralService","collateralDtosService","alcConstants","pubsub",function($q,config,label,addLoanCollateralService,collateralDtosService,alcConstants,pubsub){var addCollateralOwnership=this;function populateRelationshipPicklist(legalEntities){legalEntities=legalEntities.map(function(legalEntity){return{id:legalEntity.attributes.LLC_BI__Account__c,name:legalEntity.attributes["LLC_BI__Account__r.Name"]}});addCollateralOwnership.picklistModel={headers:[addCollateralOwnership.labels.relationshipName],displayedColumns:["name"],data:legalEntities}}function updateSelectText(){1<addCollateralOwnership.collateralAssociationEntities.length?addCollateralOwnership.selectText=addCollateralOwnership.collateralAssociationEntities.length+" "+addCollateralOwnership.labels.entityAssignmentPicklistMultiple:1===addCollateralOwnership.collateralAssociationEntities.length?addCollateralOwnership.selectText=addCollateralOwnership.collateralAssociationEntities[0].attributes["LLC_BI__Account__r.Name"].value:addCollateralOwnership.selectText=addCollateralOwnership.labels.entityAssignmentPicklistEmpty}function updateSelectedCollateralAssociations(selectedEntities){var selectedRelationshipIds=[];angular.forEach(selectedEntities,function(entity){var relationshipId=entity.attributes.LLC_BI__Account__c.value;getExistingCollateralAssociation(relationshipId)||addCollateralOwnership.collateralAssociationEntities.push(entity),selectedRelationshipIds.push(relationshipId)}),function removeUnselectedEntities(selectedRelationshipIds){for(var i=addCollateralOwnership.collateralAssociationEntities.length-1;0<=i;i--){var collAssociationRelId=addCollateralOwnership.collateralAssociationEntities[i].attributes.LLC_BI__Account__c.value,identity=addCollateralOwnership.collateralAssociationEntities[i].identity;-1===selectedRelationshipIds.indexOf(collAssociationRelId)&&(addCollateralOwnership.collateralAssociationEntities.splice(i,1),identity)&&collateralDtosService.setRemoved(identity)}}(selectedRelationshipIds),0<addCollateralOwnership.collateralAssociationEntities.length?pubsub.publish(alcConstants.topics.ownershipFieldset,addCollateralOwnership.fieldsetApi):pubsub.publish(alcConstants.topics.ownershipFieldset,null)}function getExistingCollateralAssociation(relationshipId){return addCollateralOwnership.collateralAssociationEntities.find(function(collateralAssociation){return collateralAssociation.attributes.LLC_BI__Account__c.value===relationshipId})}addCollateralOwnership.config=config.get(),addCollateralOwnership.labels=label.getLabels(),addCollateralOwnership.ownershipFieldsetMetadata=[],addCollateralOwnership.relationshipsSelectedTopic=alcConstants.topics.selectedRelationship,addCollateralOwnership.picklistTableGuid=addCollateralOwnership.config.contextId+"picklistTable",addCollateralOwnership.selectText=addCollateralOwnership.labels.entityAssignmentPicklistEmpty,addCollateralOwnership.collateralAssociationEntities=[],addCollateralOwnership.fieldsetApi=null,addCollateralOwnership.dateSet=new Set,addCollateralOwnership.preSelectedElements=[],addCollateralOwnership.$onInit=function(){addCollateralOwnership.loaded=null==addCollateralOwnership.editCollateral,addLoanCollateralService.getLegalEntities(addCollateralOwnership.config.contextId).then(populateRelationshipPicklist).catch(function(error){pubsub.publish(alcConstants.topics.hasError,error)}),pubsub.subscribe(alcConstants.topics.selectedCollateralType,addCollateralOwnership.selectCollateralType),pubsub.subscribe(addCollateralOwnership.relationshipsSelectedTopic,addCollateralOwnership.selectRelationships),pubsub.subscribe(alcConstants.topics.updateAssociations,addCollateralOwnership.updateAssociations)},addCollateralOwnership.$onDestroy=function(){pubsub.unsubscribe(alcConstants.topics.selectedCollateralType),pubsub.unsubscribe(addCollateralOwnership.relationshipsSelectedTopic),pubsub.unsubscribe(alcConstants.topics.updateAssociations)},addCollateralOwnership.updateAssociations=function(){var entity,entities=collateralDtosService.getCollateralAssociationDtos();for(entity of entities){var key,id=entity.attributes.LLC_BI__Account__c.value;for(key in entity.attributes["LLC_BI__Account__r.Name"]={value:entity.account.attributes.Name.value},addCollateralOwnership.preSelectedElements.push(id),entity.attributes)addCollateralOwnership.dateSet.has(key)&&(entity.attributes[key].value=new Date(entity.attributes[key].value).getTime())}!function updateRelationshipPicklist(){var picklistRows=addCollateralOwnership.picklistModel.data;for(var association of collateralDtosService.getCollateralAssociationDtos())-1===picklistRows.findIndex(row=>row.id===association.account.identity)&&picklistRows.push({id:association.account.identity,name:association.account.attributes.Name.value});addCollateralOwnership.picklistModel.data=picklistRows}(),updateSelectedCollateralAssociations(entities),updateSelectText(),addCollateralOwnership.loaded=!0},addCollateralOwnership.selectCollateralType=function(collateralType){var collateralConfig;collateralType?(collateralType.attributes.LLC_BI__Collateral_Configuration__c.value&&(collateralConfig=JSON.parse(collateralType.attributes.LLC_BI__Collateral_Configuration__c.value)),addCollateralOwnership.fieldsetApi=collateralConfig&&collateralConfig.hasOwnProperty(alcConstants.ownershipAssignmentFieldSetProperty)?collateralConfig[alcConstants.ownershipAssignmentFieldSetProperty]:alcConstants.ownershipAssignmentDefaultFieldSetApi,function getFieldsetMetadata(fieldsetApi){addLoanCollateralService.getFieldSetMetadata(alcConstants.ownershipAssignmentSObjectType,[fieldsetApi]).then(function(fieldsetMetadata){addCollateralOwnership.ownershipFieldsetMetadata=fieldsetMetadata.fieldSetMetadataMap[fieldsetApi];for(var field of addCollateralOwnership.ownershipFieldsetMetadata)"DATE"!==field.fieldType&&"DATETIME"!==field.fieldType||addCollateralOwnership.dateSet.add(field.fieldPath);pubsub.publish(alcConstants.topics.ownershipFieldsetMetadata,JSON.stringify(addCollateralOwnership.ownershipFieldsetMetadata))}).catch(function(error){pubsub.publish(alcConstants.topics.hasError,error)})}(addCollateralOwnership.fieldsetApi)):(addCollateralOwnership.selectText=addCollateralOwnership.labels.entityAssignmentPicklistEmpty,addCollateralOwnership.collateralAssociationEntities=[],addCollateralOwnership.fieldsetApi=null,addCollateralOwnership.ownershipFieldsetMetadata=[])},addCollateralOwnership.selectRelationships=function(picklistOptions){updateSelectedCollateralAssociations(picklistOptions.rows.map(function(relationship){return{identity:null,attributes:{LLC_BI__Account__c:{value:relationship.id},"LLC_BI__Account__r.Name":{value:relationship.name}}}})),updateSelectText(),collateralDtosService.setCollateralAssociationDtos(addCollateralOwnership.collateralAssociationEntities)},addCollateralOwnership.handleInputChange=function(relationshipId,fieldPath,value){var editedRow=getExistingCollateralAssociation(relationshipId.value);(editedRow=editedRow||{identity:null,attributes:{LLC_BI__Account__c:{value:relationshipId.value}}}).attributes[fieldPath]={value:value},collateralDtosService.updateCollateralAssociationDto(editedRow)},addCollateralOwnership.getFieldValue=function(row,field){return row.attributes[field.fieldPath]?row.attributes[field.fieldPath].value:null}}],template:__webpack_require__(97)})}()},function(module,exports){module.exports='<div class="slds-p-around--small"> <association-card ng-if="addCollateralOwnership.ownershipFieldsetMetadata.length && addCollateralOwnership.loaded"> <card-header-left> <div class="slds-m-around--small" ng-bind="addCollateralOwnership.labels.entityAssignmentHeader | uppercase"></div> </card-header-left> <card-header-right> <div ng-if="addCollateralOwnership.picklistModel"> <div> <span ng-bind="vm.labels.entityAssignmentAssignTo"></span> </div> <div> <picklist-table publish-topic="{{addCollateralOwnership.relationshipsSelectedTopic}}" select-text="{{addCollateralOwnership.selectText}}" elements="addCollateralOwnership.picklistModel.data" pre-selected-elements="addCollateralOwnership.preSelectedElements" display-columns="addCollateralOwnership.picklistModel.displayedColumns" headers="addCollateralOwnership.picklistModel.headers" multi-select-enabled="true" guid="{{addCollateralOwnership.picklistTableGuid}}"> </picklist-table> </div> </div> </card-header-right> <card-body> <nds-table> <table class="slds-table_bordered slds-table--cell-buffer"> <thead> <tr> <th ng-repeat="field in addCollateralOwnership.ownershipFieldsetMetadata" ng-bind="field.label"></th> </tr> </thead> <tbody> <tr ng-repeat="row in addCollateralOwnership.collateralAssociationEntities"> <td ng-repeat="field in addCollateralOwnership.ownershipFieldsetMetadata"> <a ng-if="field.fieldPath == \'LLC_BI__Account__r.Name\'" href="/{{row.attributes[\'LLC_BI__Account__c\'].value}}" target="_blank"> <span ng-bind="row.attributes[\'LLC_BI__Account__r.Name\'].value"></span> <nds-icon icon-type="utility" icon-name="new_window" span-class="slds-current-color" svg-class="slds-p-bottom_xx-small slds-p-left_xxx-small slds-icon_x-small" fill="#0070d2"></nds-icon> </a> <nds-form-element ng-if="field.fieldPath !== \'LLC_BI__Account__r.Name\'\n\t\t\t\t\t\t\t\t\t\t&& field.fieldType !== \'BOOLEAN\'" is-editable="true" metadata="{{field}}" hide-label="true" value="{{::addCollateralOwnership.getFieldValue(row, field)}}" ng-on-value_change="addCollateralOwnership.handleInputChange(\n\t\t\t\t\t\t\t\t\t\trow.attributes.LLC_BI__Account__c, field.fieldPath, $event.detail\n\t\t\t\t\t\t\t\t\t)" ng-on-options_array_change="addCollateralOwnership.handleInputChange(\n\t\t\t\t\t\t\t\t\t\trow.attributes.LLC_BI__Account__c, field.fieldPath, $event.detail\n\t\t\t\t\t\t\t\t\t)"></nds-form-element> <nds-input-checkbox ng-if="field.fieldType == \'BOOLEAN\'" value="{{row.attributes[field.fieldPath].value}}" ng-on-value_change="addCollateralOwnership.handleInputChange(\n\t\t\t\t\t\t\t\t\t\trow.attributes.LLC_BI__Account__c, field.fieldPath, $event.detail\n\t\t\t\t\t\t\t\t\t)"></nds-input-checkbox> </td> </tr> </tbody> </table> </nds-table> </card-body> </association-card> </div> '},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("selectCollateralType",{controllerAs:"selectCollateralType",bindings:{isLeasedAsset:"<",editCollateral:"<?"},controller:["config","label","pubsub","addLoanCollateralService","alcConstants","collateralDtosService",function(config,label,pubsub,addLoanCollateralService,alcConstants,collateralDtosService){var selectCollateralType=this;function setEditedCollateralType(collateralTypeId){selectCollateralType.selectedCollateralType.isEdit=!0;var typeName=selectCollateralType.selectedCollateralType.attributes.LLC_BI__Type__c.value;collateralDtosService.setModel(typeName),selectCollateralType.types.map(function(element){return element.value==typeName&&(element.selected=!0),element}),selectCollateralType.selectedTypeSubTypes=selectCollateralType.typeToSubtypesMap[typeName],selectCollateralType.selectedTypeSubTypes.map(function(element){return element.identity==collateralTypeId&&(element.selected=!0),element}),pubsub.publish(alcConstants.topics.selectedCollateralType,selectCollateralType.selectedCollateralType),pubsub.publish(alcConstants.topics.showLoadingIcon,!1)}function addSubTypeToTypesMap(collateralType){var type=collateralType.attributes.LLC_BI__Type__c,subType=collateralType.attributes.LLC_BI__Subtype__c,collCode=collateralType.attributes.LLC_BI__Collateral_Code__c.value?"-"+collateralType.attributes.LLC_BI__Collateral_Code__c.value:"",subTypeCollCodeLabel=subType.translation?subType.translation+collCode:subType.value+collCode,subType=subType.value+collCode;selectCollateralType.typeToSubtypesMap[type.value]?selectCollateralType.typeToSubtypesMap[type.value].push({identity:collateralType.identity,label:subTypeCollCodeLabel,value:subType}):(selectCollateralType.types.push({label:type.translation||type.value,value:type.value}),selectCollateralType.typeToSubtypesMap[type.value]=[{identity:collateralType.identity,label:subTypeCollCodeLabel,value:subType}])}selectCollateralType.config=config.get(),selectCollateralType.labels=label.getLabels(),selectCollateralType.loaded=!1,selectCollateralType.excludeGroupTypes=!0,selectCollateralType.collateralTypes=null,selectCollateralType.types=[],selectCollateralType.selectedTypeSubTypes=null,selectCollateralType.selectedCollateralType=null,selectCollateralType.selectedCollateralTypeScreen=null,selectCollateralType.typeToSubtypesMap=[{}],selectCollateralType.$onInit=function(){pubsub.publish(alcConstants.topics.showLoadingIcon,!0),selectCollateralType.loanId=selectCollateralType.config.loanId,pubsub.subscribe(alcConstants.topics.editLoaded,selectCollateralType.editLoaded),function loadCollateralTypes(){addLoanCollateralService.getCollateralTypes(selectCollateralType.loanId,selectCollateralType.isLeasedAsset,selectCollateralType.excludeGroupTypes).then(function(results){selectCollateralType.collateralTypes=results.collateralTypes;for(var x=0;x<selectCollateralType.collateralTypes.length;x++)addSubTypeToTypesMap(selectCollateralType.collateralTypes[x]);pubsub.publish(alcConstants.topics.typesLoaded,!0)}).catch(function(error){pubsub.publish(alcConstants.topics.hasError,error)}).finally(function(){selectCollateralType.editCollateral||pubsub.publish(alcConstants.topics.showLoadingIcon,!1)})}(),selectCollateralType.loaded=!0},selectCollateralType.$onDestroy=function(){pubsub.unsubscribe(alcConstants.topics.editLoaded)},selectCollateralType.editLoaded=function(collateralTypeId){selectCollateralType.selectedCollateralType=selectCollateralType.collateralTypes.find(function(collateralType){return collateralType.identity===collateralTypeId}),null==selectCollateralType.selectedCollateralType?addLoanCollateralService.getCollateralType(collateralTypeId,!0).then(function(results){results=results.collateralTypes[0];selectCollateralType.collateralTypes.push(results),addSubTypeToTypesMap(results),selectCollateralType.selectedCollateralType=results,setEditedCollateralType(collateralTypeId)}):setEditedCollateralType(collateralTypeId)},selectCollateralType.onTypeSelect=function(type){collateralDtosService.setModel(type),selectCollateralType.selectedTypeSubTypes=[],selectCollateralType.selectedTypeSubTypes=selectCollateralType.typeToSubtypesMap[type],selectCollateralType.selectedCollateralType&&(selectCollateralType.selectedCollateralType=null,pubsub.publish(alcConstants.topics.selectedCollateralType,!1))},selectCollateralType.onSubTypeSelect=function(subType){var selectedSubtype=selectCollateralType.selectedTypeSubTypes.find(function(sType){return sType.value===subType});selectCollateralType.selectedCollateralType=selectCollateralType.collateralTypes.find(function(collateralType){return collateralType.identity===selectedSubtype.identity}),pubsub.publish(alcConstants.topics.selectedCollateralType,selectCollateralType.selectedCollateralType)}}],template:__webpack_require__(99)})}()},function(module,exports){module.exports='<div> <div class="section-header slds-m-around--small" ng-bind="selectCollateralType.labels.editTypeHeader | uppercase"></div> <div ng-if="selectCollateralType.loaded"> <div class="slds-form-element__row slds-grid"> <div class="slds-form-element slds-size--1-of-2 slds-p-horizontal--small"> <nds-input-picklist label="{{:: selectCollateralType.labels.type}}" required="true" options="{{selectCollateralType.types}}" emit-string="true" allow-deselect="false" ng-on-options_array_change="selectCollateralType.onTypeSelect($event.detail)" native-element="true"> </nds-input-picklist> </div> <div class="slds-form-element slds-size--1-of-2 slds-p-horizontal--small"> <nds-input-picklist label="{{::selectCollateralType.labels.subType}}" required="true" options="{{selectCollateralType.selectedTypeSubTypes}}" emit-string="true" allow-deselect="false" ng-on-options_array_change="selectCollateralType.onSubTypeSelect($event.detail)" native-element="true"> </nds-input-picklist> </div> </div> </div> </div> '},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("vehicleValuation",{controllerAs:"vehicleValuation",bindings:{vehicleValuationProvider:"<"},controller:["config","label","addLoanCollateralService","messageService","pubsub","alcConstants",function(config,label,addLoanCollateralService,messageService,pubsub,alcConstants){var vehicleValuation=this;vehicleValuation.config=config.get(),vehicleValuation.labels=label.getLabels(),vehicleValuation.valuationMethods=[],vehicleValuation.loaded=!1,vehicleValuation.routeMissing=!1,vehicleValuation.valuationState=null,vehicleValuation.selectedValuationMethod=null,vehicleValuation.$onInit=function(){pubsub.subscribe(alcConstants.topics.selectedCollateralType,function(collateralType){collateralType?vehicleValuation.collateralTypeUpdate(collateralType.identity):(vehicleValuation.resetState(),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState))}),addLoanCollateralService.checkRouteExists().then(function(results){vehicleValuation.routeMissing=!(0<results.length),vehicleValuation.resetState(),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState),vehicleValuation.loaded=!0},function(error){messageService.setMessage({type:messageService.messageTypes.error,text:error}),vehicleValuation.resetState(),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState),vehicleValuation.loaded=!0}),addLoanCollateralService.getValuationLabels().then(function(results){vehicleValuation.valuationMethods=[results.Search_With_Vehicle_Valuation,vehicleValuation.labels.Enter_Value_Manually]},function(error){messageService.setMessage({type:messageService.messageTypes.error,text:error})})},vehicleValuation.$onDestroy=function(){vehicleValuation.resetState(),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState),pubsub.unsubscribe(alcConstants.topics.selectedCollateralType)},vehicleValuation.collateralTypeUpdate=function(typeId){addLoanCollateralService.getValuationMethods(vehicleValuation.config.contextId,typeId).then(function(results){for(var valProviderFound=!1,i=0;i<results.length;i++)if(results[i].startsWith(vehicleValuation.vehicleValuationProvider)){valProviderFound=vehicleValuation.valuationState.showVehicleValuation=!0;break}valProviderFound||vehicleValuation.resetState(),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState)},function(error){messageService.setMessage({type:messageService.messageTypes.error,text:error})})},vehicleValuation.resetState=function(){vehicleValuation.valuationState={showVehicleValuation:!1,isProviderValuation:!1,isManualValuation:!1,routeMissing:vehicleValuation.routeMissing},vehicleValuation.selectedValuationMethod=null},vehicleValuation.valuationMethodSelected=function(valuationMethod){(vehicleValuation.selectedValuationMethod=valuationMethod)==vehicleValuation.valuationMethods[0]?(vehicleValuation.valuationState.isProviderValuation=!0,vehicleValuation.valuationState.isManualValuation=!1,pubsub.publish(alcConstants.topics.collateralFieldsets,JSON.stringify([]))):(vehicleValuation.valuationState.isProviderValuation=!1,vehicleValuation.valuationState.isManualValuation=!0),pubsub.publish(alcConstants.topics.valuationState,vehicleValuation.valuationState)}}],template:__webpack_require__(101)})}()},function(module,exports){module.exports='<div ng-if="vehicleValuation.valuationState && vehicleValuation.valuationState.showVehicleValuation"> <div class="section-header slds-m-around--small" ng-bind="vehicleValuation.labels.Valuation_Choice | uppercase"></div> <div class="slds-p-horizontal--medium"> <div class="slds-p-bottom--small" ng-bind="vehicleValuation.labels.How_Would_You_Like_To_Enter"></div> <div class="slds-button-group" role="group"> <button ng-repeat="valuationMethod in vehicleValuation.valuationMethods" class="slds-button" ng-class="\n\t\t\t\t\tvehicleValuation.selectedValuationMethod == valuationMethod\n\t\t\t\t\t\t? \'slds-button--brand\'\n\t\t\t\t\t\t: \'slds-button--neutral\'\n\t\t\t\t" ng-click="vehicleValuation.valuationMethodSelected(valuationMethod)" ng-bind="valuationMethod"></button> </div> </div> </div> '},function(module,exports,__webpack_require__){!function(){"use strict";angular.module("ncAddLoanCollateral").component("addCollateralValuation",{controllerAs:"addCollateralValuation",bindings:{editCollateral:"<?"},controller:["config","pubsub","addLoanCollateralService","collateralDtosService","alcConstants","$scope",function(config,pubsub,addLoanCollateralService,collateralDtosService,alcConstants,$scope){var addCollateralValuation=this;addCollateralValuation.collateralDetailsForm=void 0,addCollateralValuation.config=config.get(),addCollateralValuation.currencyIsoCode=addCollateralValuation.config.userDefaultISO,addCollateralValuation.isMultiCurrencyOrg=addCollateralValuation.config.isMultiCurrencyEnabled,addCollateralValuation.loaded=!1,addCollateralValuation.collateralEntity={},addCollateralValuation.collateralFormMetadata={},addCollateralValuation.fieldMetadatas=[],addCollateralValuation.valuationFieldsets=[],addCollateralValuation.hasRequiredFields=!1,addCollateralValuation.conditionalDisplayCriteria=null,addCollateralValuation.currencyFields=[],addCollateralValuation.hasCurrencyIsoCode=!1,addCollateralValuation.$onInit=function(){pubsub.subscribe(alcConstants.topics.selectedCollateralType,function(collateralType){var colAttributes,editArgs;pubsub.publish(alcConstants.topics.collateralFieldsets,JSON.stringify(null)),addCollateralValuation.collateralDetailsForm=void 0,addCollateralValuation.hasRequiredFields=!1,collateralType?(pubsub.publish(alcConstants.topics.showLoadingIcon,!0),addCollateralValuation.collateralEntity={identity:addCollateralValuation.editCollateral,attributes:{LLC_BI__Collateral_Type__c:collateralType.identity}},colAttributes={LLC_BI__Collateral_Type__c:{value:collateralType.identity}},addCollateralValuation.isMultiCurrencyOrg&&(colAttributes.CurrencyIsoCode={value:addCollateralValuation.currencyIsoCode}),collateralDtosService.setCollateralDto({identity:addCollateralValuation.editCollateral,attributes:colAttributes}),colAttributes=collateralType.attributes.LLC_BI__Collateral_Configuration__c.value,editArgs={},colAttributes&&(colAttributes=JSON.parse(colAttributes),editArgs.collateralAssociationFS=[colAttributes.ownershipAssignmentFieldSetName],editArgs.returnAllAssociationRecords=!0),addCollateralValuation.sections=[],addCollateralValuation.screenId=collateralType.attributes.LLC_BI__Screen__c.value,""!==addCollateralValuation.screenId&&addLoanCollateralService.getScreenMetadata([addCollateralValuation.screenId],null).then(function(sections){sections.screenData.forEach(function(screen,index){var fsmd=addCollateralValuation.processFieldsetMetadata(screen.fieldsetMetadata);if(addCollateralValuation.fieldMetadatas.push(fsmd),addCollateralValuation.sections.push({contextObject:screen.contextObject,sectionHeader:screen.sectionHeader,fieldsetMetadata:fsmd,collateralEntity:addCollateralValuation.collateralEntity,dynamicFields:"true"===addCollateralValuation.config.enableDynamicFields?screen.dynamicFields:null}),!0!==addCollateralValuation.hasRequiredFields&&pubsub.publish(alcConstants.topics.collateralFieldsets,JSON.stringify(addCollateralValuation.valuationFieldsets)),collateralType.isEdit){editArgs.collateralManagementFS=[],editArgs.collateralDetailFields={},editArgs.collateralManagementIds=[addCollateralValuation.editCollateral],editArgs.returnAllAssociationRecords=!0;var section,detailRelation=collateralDtosService.getDetailRelation(collateralType.attributes.LLC_BI__Type__c.value),contextObject=detailRelation.slice(0,detailRelation.length-1)+"c",dateFields=new Set;for(section of addCollateralValuation.sections){editArgs.collateralManagementFS.push(section.fieldsetMetadata.identity);for(var field of section.fieldsetMetadata.fieldMetadata){var path=field.fieldPath.split(".");path[0]==detailRelation&&(editArgs.collateralDetailFields[contextObject]?editArgs.collateralDetailFields[contextObject].push(path[1]):editArgs.collateralDetailFields[contextObject]=[path[1]]),"CurrencyIsoCode"===field.fieldPath&&(addCollateralValuation.hasCurrencyIsoCode=!0),"DATE"!==field.fieldType&&"DATETIME"!==field.fieldType||dateFields.add(field.fieldPath)}if(addCollateralValuation.hasCurrencyIsoCode)for(var field of section.fieldsetMetadata.fieldMetadata)addCollateralValuation.currencyFields.includes(field.fieldPath)&&(delete field.scale,field.isoCode=addCollateralValuation.currencyIsoCode)}addLoanCollateralService.getCollateralsWithArgs(editArgs).then(function(results){addCollateralValuation.buildDTO(results.collaterals[0],detailRelation,dateFields),setTimeout(function(){addCollateralValuation.updateValidity(),$scope.$apply()},100),addCollateralValuation.loaded=!0})}}),pubsub.publish(alcConstants.topics.collateralFieldsetMetadatas,JSON.stringify(addCollateralValuation.fieldMetadatas))}).catch(function(error){pubsub.publish(alcConstants.topics.hasError,error)}).finally(function(){addCollateralValuation.loaded=!collateralType.isEdit,pubsub.publish(alcConstants.topics.showLoadingIcon,!1)})):(addCollateralValuation.collateralEntity={},addCollateralValuation.collateralFormMetadata={},addCollateralValuation.valuationFieldsets=[],addCollateralValuation.sections=[])}),pubsub.subscribe(alcConstants.topics.valuationState,function(state){state.isManualValuation&&addCollateralValuation.updateValidity()})},addCollateralValuation.$onDestroy=function(){pubsub.unsubscribe(alcConstants.topics.valuationState),pubsub.unsubscribe(alcConstants.topics.selectedCollateralType)},addCollateralValuation.getLookupSearchResults=function($event){var searchQuery=$event.detail,lookupInputComponent=$event.target,$event=lookupInputComponent.getAttribute("fieldPath");null==searchQuery||searchQuery.length<=1?lookupInputComponent.searchResults=[]:addLoanCollateralService.getLookupSearchResults(searchQuery,$event).then(function(searchResults){lookupInputComponent.searchResults=searchResults}).catch(function(error){pubsub.publish(alcConstants.topics.hasError,error)})},addCollateralValuation.updateSelectedLookupResult=function($event){var selectedId=$event.detail,$event=$event.target.getAttribute("fieldPath");addCollateralValuation.collateralEntity.attributes[$event]=selectedId,collateralDtosService.updateCollateralDto({value:selectedId,fieldPath:$event}),addCollateralValuation.updateValidity()},addCollateralValuation.updateProperties=function($event){$event=$event.detail;"CurrencyIsoCode"===$event.fieldPath&&(addCollateralValuation.currencyIsoCode=$event.value,addCollateralValuation.updateCurrencyIso()),null!==$event.fieldPath&&(addCollateralValuation.collateralEntity.attributes[$event.fieldPath]=$event.value,collateralDtosService.updateCollateralDto($event),addCollateralValuation.updateValidity())},addCollateralValuation.isFormComplete=function(){return addCollateralValuation.collateralDetailsForm[0].checkValidity()},addCollateralValuation.updateValidity=function(){addCollateralValuation.isFormComplete()?pubsub.publish(alcConstants.topics.collateralFieldsets,JSON.stringify(addCollateralValuation.valuationFieldsets)):pubsub.publish(alcConstants.topics.collateralFieldsets,JSON.stringify(null))},addCollateralValuation.processFieldsetMetadata=function(fieldsetMetadataString){for(var fieldsetMetadataString=JSON.parse(fieldsetMetadataString),fieldsetName=fieldsetMetadataString.identity,fields=(addCollateralValuation.valuationFieldsets.push(fieldsetName),fieldsetMetadataString.fieldMetadata),i=0;i<fields.length;i++){var currentAttribute=addCollateralValuation.collateralEntity.attributes[fields[i].fieldPath];fields[i].showToggle=!1,fields[i].required&&(addCollateralValuation.hasRequiredFields=!0),"CurrencyIsoCode"==fields[i].fieldPath&&(fields[i].defaultValue=addCollateralValuation.currencyIsoCode),"LLC_BI__Collateral_Type__c"==fields[i].fieldPath?(fields[i].disabled=!0,fields[i].displayValue=currentAttribute,fields[i].value="/"+currentAttribute,fields[i].target="_blank"):(null!=fields[i].defaultValue&&null==currentAttribute&&(addCollateralValuation.collateralEntity.attributes[fields[i].fieldPath]=fields[i].defaultValue),"CURRENCY"===fields[i].fieldType&&(fields[i].isoCode=addCollateralValuation.currencyIsoCode,delete fields[i].scale,addCollateralValuation.currencyFields.push(fields[i].fieldPath)),fields[i].nativeElement="true",null==fields[i].helpText&&(fields[i].helpText=""))}return fieldsetMetadataString},addCollateralValuation.updateCurrencyIso=function(){addCollateralValuation.fieldMetadatas.forEach(function(fsmd,index){fsmd.fieldMetadata.forEach(function(field){addCollateralValuation.currencyFields.includes(field.fieldPath)&&(field.isoCode=addCollateralValuation.currencyIsoCode)})})},addCollateralValuation.buildDTO=function(dto,detailRelation,dateSet){var key;detailRelation+=".";for(key of Object.keys(dto.attributes))dateSet.has(key)?(addCollateralValuation.collateralEntity.attributes[key]=new Date(dto.attributes[key].value).getTime(),dto.attributes[key].value=new Date(dto.attributes[key].value).getTime()):(addCollateralValuation.collateralEntity.attributes[key]=dto.attributes[key].value,addCollateralValuation.hasCurrencyIsoCode&&"CurrencyIsoCode"===key&&(addCollateralValuation.currencyIsoCode=addCollateralValuation.collateralEntity.attributes[key],addCollateralValuation.updateCurrencyIso()));if(dto.collateralDetail){dto.collateralDetail.attributes||(dto.collateralDetail.attributes={});for(key of Object.keys(dto.collateralDetail.attributes))dateSet.has(detailRelation+key)?(addCollateralValuation.collateralEntity.attributes[detailRelation+key]=new Date(dto.collateralDetail.attributes[key].value).getTime(),dto.collateralDetail.attributes[key].value=new Date(dto.collateralDetail.attributes[key].value).getTime()):addCollateralValuation.collateralEntity.attributes[detailRelation+key]=dto.collateralDetail.attributes[key].value}collateralDtosService.setFullDto(dto),pubsub.publish(alcConstants.topics.updateAssociations,"true")}}],template:__webpack_require__(103)})}()},function(module,exports){module.exports='<div ng-if="addCollateralValuation.loaded"> <div ng-repeat="section in addCollateralValuation.sections"> <div class="section-header slds-m-around--small" ng-bind="section.sectionHeader | uppercase"></div> <nds-form columns="2" is-editable="true" ng-ref="addCollateralValuation.collateralDetailsForm" form-entity="{{ addCollateralValuation.collateralEntity }}" form-metadata="{{ section.fieldsetMetadata.fieldMetadata }}" conditional-display-criteria="{{ section.dynamicFields }}" ng-on-form_value_change="addCollateralValuation.updateProperties($event)" ng-on-search_value_change="addCollateralValuation.getLookupSearchResults($event)" ng-on-selected_id_change="addCollateralValuation.updateSelectedLookupResult($event)" enable-lookup-search="true"></nds-form> </div> </div> '},function(module,exports){!function(){"use strict";angular.module("ncAddLoanCollateral").service("addLoanCollateralService",function addLoanCollateralService(config,$q,remotingManager,collateralUtil){var configData=config.get();function invokeRemoteAction(endpoint,params,escape){var deferred=$q.defer();return remotingManager.invokeAction(configData.remoteActionInvoke,endpoint,params,function(result,event){collateralUtil.setDeferred(deferred,result,event)},{escape:!1!==escape}),deferred.promise}this.getFieldSetMetadata=function(contextType,fieldsets){return invokeRemoteAction(configData.endpoints.fieldsetMetadataLoaderEndpoint,{args:JSON.stringify({filters:{contextType:contextType,identities:fieldsets}})})},this.getScreenMetadata=function(screenIds,screenLookupKeys){screenIds={ACTION:"LLC_BI.ColScreenMetadataServiceXPkg",ACTION_ARGS:JSON.stringify({screenIds:screenIds,screenLookupKeys:screenLookupKeys}),VERIFY_ACTION:!0};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,screenIds,!1)},this.getCollateralTypes=function(loanId,isLeasedAsset,excludeGroupTypes){loanId={ACTION:"LLC_BI.CollateralTypesLoaderXPkg",ACTION_ARGS:JSON.stringify({loanId:loanId,isLeasedAsset:isLeasedAsset,excludeGroupTypes:excludeGroupTypes})};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,loanId,!1)},this.getCollateralType=function(collateralTypeId,includeInactiveTypes){collateralTypeId={ACTION:"LLC_BI.CollateralTypesLoaderXPkg",ACTION_ARGS:JSON.stringify({identities:[collateralTypeId],includeInactiveTypes:includeInactiveTypes})};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,collateralTypeId,!1)},this.getCollaterals=function(collateralId){collateralId={ACTION:"LLC_BI.CollateralsLoaderXPkg",ACTION_ARGS:JSON.stringify({collateralManagementIds:[collateralId]})};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,collateralId,!1)},this.getCollateralsWithArgs=function(args){args={ACTION:"LLC_BI.CollateralsLoaderXPkg",ACTION_ARGS:JSON.stringify(args)};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,args,!1)},this.getLegalEntities=function(contextId){return invokeRemoteAction(configData.endpoints.borrowingStructureLoaderEndpoint,{args:JSON.stringify({filters:{identities:[contextId]}})},!1).then(function(results){return results[0].legalEntities})},this.getValuationMethods=function(loanId,collateralTypeId){return invokeRemoteAction(configData.endpoints.getValuationMethodsForCollateralType,{loanId:loanId,collateralTypeId:collateralTypeId},!1)},this.getValuationLabels=function(){return invokeRemoteAction(configData.endpoints.getVehicleValuationLabels,{},!1)},this.checkRouteExists=function(){return invokeRemoteAction(configData.endpoints.getRouteByApp,{appName:"vehicle-valuation"},!1)},this.saveCollaterals=function(collateral,collateralFieldsetNames,collAssociationFieldsetName){collateral={ACTION:configData.endpoints.saveCollateralsEndpoint,ACTION_ARGS:JSON.stringify({collaterals:JSON.stringify([collateral]),collateralFieldSetNames:collateralFieldsetNames,collateralAssociationFieldSetName:collAssociationFieldsetName}),VERIFY_ACTION:!0};return invokeRemoteAction(configData.endpoints.remotingApiEndpoint,collateral,!1)},this.getLookupSearchResults=function(searchQuery,fieldName){return invokeRemoteAction(configData.endpoints.lookupSearchEndpoint,{searchQuery:searchQuery,fieldName:fieldName},!1)}})}()},function(module,exports){!function(){"use strict";angular.module("ncAddLoanCollateral").service("collateralDtosService",function collateralDtosService(){var service=this;service.collateralDto={},service.collateralAssociationDtos=[{}],service.removedAssociations=[],service.model="",service.setFullDto=function(dto){(service.collateralDto=dto).collateralAssociationsXPkgDtos&&(service.collateralAssociationDtos=dto.collateralAssociationsXPkgDtos)},service.setCollateralAssociationDtos=function(collateralAssociationDtos){service.collateralAssociationDtos=collateralAssociationDtos},service.getCollateralAssociationDtos=function(){return service.collateralAssociationDtos},service.setModel=function(model){service.model=model},service.updateCollateralAssociationDto=function(collateralAssociationDto){var relationshipId=collateralAssociationDto.attributes.LLC_BI__Account__c.value,collAssociationDto=service.collateralAssociationDtos.find(function(dto){return dto.attributes.LLC_BI__Account__c.value===relationshipId});collAssociationDto?collAssociationDto.attributes=collateralAssociationDto.attributes:(collAssociationDto={identity:collateralAssociationDto.identity,attributes:collateralAssociationDto.attributes},service.collateralAssociationDtos.push(collAssociationDto))},service.setCollateralDto=function(collateral){service.collateralDto=collateral},service.updateCollateralDto=function(attribute){null!=attribute.value?service.collateralDto.attributes[attribute.fieldPath]={value:attribute.value}:null===attribute.value&&null!==service.collateralDto.attributes[attribute.fieldPath]&&delete service.collateralDto.attributes[attribute.fieldPath]},service.getCollateralDto=function(){null==service.collateralDto.collateralDetail&&(service.collateralDto.collateralDetail={identity:null,attributes:{}});var key,relationship=service.getDetailRelation(service.model);for(key of Object.keys(service.collateralDto.attributes)){var path=key.split(".");1<path.length&&path[0]==relationship&&(service.collateralDto.collateralDetail.attributes[path[1]]=service.collateralDto.attributes[key],delete service.collateralDto.attributes[key])}return service.collateralDto.collateralAssociationsXPkgDtos=service.collateralAssociationDtos,service.collateralDto.model=service.model,service.collateralDto.collateralDetail.model=service.model,service.collateralDto},service.setRemoved=function(identity){service.removedAssociations.push({identity:identity,attributes:{},shouldRemove:!0})},service.getRemovedAssociations=function(identity){return service.removedAssociations},service.resetRemoved=function(identity){service.removedAssociations=[]},service.resetAttributes=function(){service.collateralDto.attributes={LLC_BI__Collateral_Type__c:{value:service.collateralDto.attributes.LLC_BI__Collateral_Type__c.value}}},service.getDetailRelation=function(colType){return"Titled"==colType?"LLC_BI__Titled_Property_Details__r":"Real Estate"==colType?"LLC_BI__Real_Estate_Property_Details__r":"UCC"==colType?"LLC_BI__UCC_Property_Details__r":"Possessory"==colType?"LLC_BI__Possessory_Property_Details__r":"LLC_BI__Other_Property_Details__r"}})}()},function(module,exports){!function(){"use strict";angular.module("ncAddLoanCollateral").constant("alcConstants",{topics:{showLoadingIcon:"AddLoanCollateral.showLoadingIcon",selectedCollateralType:"AddLoanCollateral.selectedCollateralType",selectedRelationship:"AddLoanCollateral.selectedRelationship",valuationState:"AddLoanCollateral.valuationState",ownershipFieldset:"AddLoanCollateral.ownershipFieldset",ownershipFieldsetMetadata:"AddLoanCollateral.ownershipFieldsetMetadata",collateralFieldsets:"AddLoanCollateral.collateralFieldsets",collateralFieldsetMetadatas:"AddLoanCollateral.collateralFieldsetMetadatas",buildPledgeModel:"AddLoanCollateral.buildPledgeModel",hasError:"AddLoanCollateral.hasError",typesLoaded:"AddLoanCollateral.typesLoaded",editLoaded:"AddLoanCollateral.editLoaded",updateAssociations:"AddLoanCollateral.updateAssociations"},appVariable:"?app=",vehicleValuationApp:"vehicle-valuation",idVariable:"&id=",collateralVariable:"&collateralId=",warningElementId:"vvRouteWarning",footerClass:"slds-modal__footer",apex:"/apex/",ownershipAssignmentFieldSetProperty:"ownershipAssignmentFieldSetName",ownershipAssignmentDefaultFieldSetApi:"LLC_BI__Bulk_Ownership_Assignment",ownershipAssignmentSObjectType:"LLC_BI__Account_Collateral__c"})}()}]);